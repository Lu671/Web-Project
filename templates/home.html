{% extends 'base.html' %}

{% block content %}
    <div>
        <button onclick="prevMonth()">Previous Month</button>
        <button onclick="nextMonth()">Next Month</button>
    </div>
    <table id="calendar"></table>
    <p><strong>Note:</strong> Yellow cell indicates today's date.</p>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
    
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            border: 1px solid #ddd;
            text-align: center;
            padding: 8px;
            cursor: pointer;
        }

        th {
            background-color: #f2f2f2;
        }

        td:hover {
            background-color: #f2f2f2;
        }

        .today {
            background-color: #e7cd80;
        }
    </style>
    
    <script>
        var currentMonth = moment().month();
        var currentYear = moment().year();

        function generateCalendar(month, year) {
            var daysInMonth = moment([year, month]).daysInMonth();
            var firstDay = moment([year, month, 1]).day();

            var calendar = document.getElementById('calendar');
            calendar.innerHTML = '<caption><strong>' + moment([year, month]).format('MMMM YYYY') + '</strong></caption>';
            calendar.innerHTML += '<tr><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th></tr>';

            var day = 1;
            for (var i = 0; i < 6; i++) {
                var row = '<tr>';
                for (var j = 0; j < 7; j++) {
                    if ((i === 0 && j < firstDay) || day > daysInMonth) {
                        row += '<td></td>';
                    } else {
                        var cellDate = moment([year, month, day]);
                        var className = cellDate.isSame(moment(), 'day') ? 'today' : '';
                        row += '<td class="' + className + '">' + day + '</td>';
                        day++;
                    }
                }
                row += '</tr>';
                calendar.innerHTML += row;
                if (day > daysInMonth) break;
            }
        }

        function prevMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateCalendar(currentMonth, currentYear);
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateCalendar(currentMonth, currentYear);
        }

        generateCalendar(currentMonth, currentYear);
    </script>
{% endblock %}
